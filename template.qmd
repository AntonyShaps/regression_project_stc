---
title: "group10"
author: "group10"
embed-resources: true
number-sections: true
df-print: kable
fig-align: center
format:
  pdf:
    toc: true
editor: visual
---

# Introduction

The primary objective of this analysis is to investigate the relationship between net income from interest, dividends, and profit from capital investments (`py090n`)(unemployment benefits?) and the predictors `gender`, `citizenship`, `hsize` (household size), and `age` in the region of West Austria. Descriptive statistics will be used to understand the distribution and relationships among the variables in this subset of the EUSILC-P dataset.

Methods of analysis include univariate visualizations, bivariate comparisons, and the exploration of potential interactions among predictors to guide subsequent regression modeling.

# Data Collection

The dataset originates from the EUSILC-P survey, which collects comprehensive social and economic data.

-   **Survey Type**: Longitudinal survey
-   **Data Characteristics**:
    -   Variables: `py090n`, `gender`, `citizenship`, `hsize`, `age,`
    -   Scale Levels: Numerical(`py090n`, `age`, `hsize`), Categorical (`gender`, `citizenship`)
    -   Missing Values: Handled using imputation where necessary.

Below is the R code used for loading and preparing the data:

5 univariate, 5 bivariate , 4 joint

```{r setup}
library(tidyverse)
library(simFrame)
library(forcats)
library(gridExtra)
library(patchwork)
data(eusilcP)
```

```{r show_head}
head(eusilcP)
```

```{r}
# Filter dataset to include only entries from the West Austria region
west_austria <- eusilcP %>% 
  filter(region %in% c("Vorarlberg", "Tyrol", "Salzburg", "Upper Austria"))

west_austria <- west_austria %>% select(gender, citizenship, hsize, age, py090n)

# Transform hsize to integer
west_austria$hsize <- as.integer(as.character(west_austria$hsize))

# rename py090n to benefits
west_austria <- west_austria %>% rename(benefits = py090n)

# Summarize to identify potential data quality issues
summary(west_austria)

```

Filtered data contains a lot of NAs. Dropping it all together may damage the possible underlying patterns. Let's check what are those values exaclty, maybe there is some relations between NAs

```{r}
rows_with_NA <- west_austria %>% filter(if_any(everything(), is.na))
summary(rows_with_NA)
```

Interestingly, all the data, which contains at lease one NA value in a row consists of children (age summary ranges between -1 and 15), which explains NAs in py090n as it represents unemployment benefits( children are not eligible for unemployment benefits). Also, all the NAs in citizenship are children respectively. Maybe this subset of data directly represents all of the children from the data. Let's check everyone with age less than 16.

```{r}
rows_with_age_below_16 <- west_austria %>% filter(age < 16)
summary(rows_with_age_below_16)
```

Indeed, our hypothesis have been confirmed as we can directly see that all persons below 16 are the same persons from previous analysis as it includes the same NA's. So it will make sense to totally remove this subset of the data as it represents children, who are not eligible for unemployment benefits

```{r}
west_austria <- west_austria[complete.cases(west_austria), ]

summary(west_austria)
```

# Descriptive Analysis

## Univariate Analysis

### Net Income (`py090n`)

Net income represents the earnings from interest, dividends, and capital investments. Its distribution helps understand the financial background of individuals in West Austria.

```{r py090n_hist}
# Create a histogram to visualize the distribution of net income
hist(west_austria$benefits, 
     col = "blue", 
     main = "Distribution of Unemployment Benefits", 
     xlab = "Unemployment Benefits", 
     ylab = "Frequency")
```

As there are too many persons with 0 unemployment benefits, plotting with zero value included does not provide a lot of information, we can plo it excluding zero value

```{r}
west_austria_filtered <- subset(west_austria, benefits != 0)

# Histogram for non-zero unemployment benefits
p1 <- ggplot(west_austria_filtered, aes(x = benefits)) +
  geom_histogram(binwidth = 500, fill = "blue", color = "black") +
  labs(title = "Distribution of Unemployment Benefits",
       x = "Unemployment Benefits", y = "Frequency") +
  theme_light()

# Boxplot for non-zero unemployment benefits by gender
p2 <- ggplot(west_austria_filtered, aes(x = "", y = benefits)) +
  geom_boxplot() + 
  theme_light()

# Arrange plots side by side
(p1 | p2) + plot_annotation(title = "Distribution of Unemployment Benefits")
```

### Age Distribution

Age represents the individual's age at the time of the survey. Its distribution gives insights into the demographic structure of the dataset.

```{r}
# Histogram for non-zero unemployment benefits
p1 <- ggplot(west_austria_filtered, aes(x = age)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black") +
  labs(title = "Distribution of Unemployment Benefits",
       x = "Unemployment Benefits", y = "Frequency") +
  theme_light()

# Boxplot for non-zero unemployment benefits by gender
p2 <- ggplot(west_austria_filtered, aes(x = "", y = age)) +
  geom_boxplot() + 
  theme_light()

# Arrange plots side by side
(p1 | p2) + plot_annotation(title = "Distribution of Unemployment Benefits")
```

### Household Size (`hsize`)

Household size represents the number of people in a household. Its distribution is essential to analyze living conditions.

```{r}
# Histogram for non-zero unemployment benefits
p1 <- ggplot(west_austria_filtered, aes(x = hsize)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black") +
  labs(title = "Distribution of Unemployment Benefits",
       x = "Unemployment Benefits", y = "Frequency") +
  theme_light()

# Boxplot for non-zero unemployment benefits by gender
p2 <- ggplot(west_austria_filtered, aes(x = "", y = hsize)) +
  geom_boxplot() + 
  theme_light()

# Arrange plots side by side
(p1 | p2) + plot_annotation(title = "Distribution of Unemployment Benefits")
```

### Gender Distribution

The `gender` variable indicates whether individuals are male or female. The distribution provides insight into the gender representation in the dataset.

```{r gender_bar}
# Create a bar plot to show the distribution of genders in the dataset
table_gender <- table(west_austria$gender)
ggplot(west_austria, aes(x = gender, fill = gender)) +
  geom_bar() +
  scale_fill_brewer(palette = "Set1") +
  labs(title = "Distribution of Sex", x = "Sex", y = "Count") +
  theme_light() +
  geom_text(stat = "count", aes(label = after_stat(count)), vjust = -0.5)+
  ylim(0, 10000)

```

Both categories have approximately equal distribution.

### Citizenship

The `citizenship` variable differentiates between Austrian citizens and foreigners. This distribution helps understand the dataset's demographic diversity.

```{r citizenship_bar}
# Create a bar plot to show the distribution of citizenship statuses
# including the citizenship labels in the axis
# label NA as unknown
# sort by count, citizenship is a factor
#table_citizenship <- table(west_austria$citizenship)
ggplot(west_austria, aes(x = fct_infreq(citizenship), fill = citizenship)) +
  geom_bar() +
  scale_fill_brewer(palette = "Set1") +
  labs(title = "Distribution of Sex", x = "Sex", y = "Count") +
  theme_light() +
  geom_text(stat = "count", aes(label = after_stat(count)), vjust = -0.5)+
  ylim(0, 16000)
```

## Bivariate Analysis

### Gender and Net Income

This comparison helps understand the income distribution across genders.

```{r gender_income_box}
# Create boxplots to compare net income across genders
ggplot(west_austria_filtered, aes(x = gender, y = benefits, fill = gender)) +
  geom_boxplot() +
  labs(title = "Net Income by Gender",
       x = "Gender",
       y = "Net Income") +
  theme_light()

```

### Citizenship and Net Income

This analysis highlights the income differences between Austrian citizens and foreigners.

```{r citizenship_income_box}
# Create boxplots to compare net income across citizenship statuses
ggplot(west_austria_filtered, aes(x = citizenship, y = benefits, fill = gender)) +
  geom_boxplot() +
  labs(title = "Net Income by Gender",
       x = "Gender",
       y = "Net Income") +
  theme_light()

```

### Age and Net Income

Exploring this relationship helps identify trends or patterns in income with respect to age.

```{r age_income_scatter}


ggplot(west_austria_filtered, aes(x = age, y = benefits)) +
  geom_point(color = "blue", alpha = 0.7) +  # Scatter points
  geom_smooth(method = "lm", color = "red", se = FALSE) +  # Regression line
  labs(title = "Net Income vs Age",
       x = "Age",
       y = "Net Income") +
  theme_light()
```

### Household Size and Net Income

Analyzing this relationship provides insights into how income varies with household size.

```{r hsize_income_scatter}
# Create a scatter plot to explore the relationship between household size and net income
ggplot(west_austria_filtered, aes(x = factor(hsize), y = benefits, fill = factor(hsize))) +
  geom_boxplot(outlier.color = "red", outlier.shape = 16) +
  scale_fill_brewer(palette = "Set2") +  # Adjust fill colors
  labs(title = "Net Income vs Household Size",
       x = "Household Size",
       y = "Net Income") +
  theme_light()
```

### Joint variables

gender x hsize x benefits

```{r}
p1 <- ggplot(west_austria_filtered, aes(x = factor(hsize), y = benefits, fill = gender)) +
  geom_boxplot(outlier.color = "red", outlier.shape = 16) +
  labs(title = "Benefits by Gender and Household Size",
       x = "Household Size",
       y = "Benefits") +
  scale_fill_brewer(palette = "Set2") +
  theme_light()
p1
```

Gender x age x benefits

```{r}
p2 <- ggplot(west_austria_filtered, aes(x = age, y = benefits, color = gender)) +
  geom_point(alpha = 0.7) +
  geom_smooth(method = "lm", se = FALSE) +
  labs(title = "Benefits by Gender and Age",
       x = "Age",
       y = "Benefits") +
  theme_light()
p2
```

Citizenship x hsize x benefits

```{r}
p3 <- ggplot(west_austria_filtered, aes(x = factor(hsize), y = benefits, fill = citizenship)) +
  geom_boxplot(outlier.color = "red", outlier.shape = 16) +
  labs(title = "Benefits by Citizenship and Household Size",
       x = "Household Size",
       y = "Benefits") +
  scale_fill_brewer(palette = "Set3") +
  theme_light()
p3
```

Citizenship x Age x Benefits

```{r}
p4 <- ggplot(west_austria_filtered, aes(x = age, y = benefits, color = citizenship)) +
  geom_point(alpha = 0.7) +
  geom_smooth(method = "lm", se = TRUE, formula = y~x) +
  labs(title = "Benefits by Citizenship and Age",
       x = "Age",
       y = "Benefits") +
  theme_light()
p4
```

# Summary

The descriptive analysis reveals key patterns in the dataset. The distribution of net income is skewed, and there are noticeable differences in income across genders and citizenships. Age and household size appear to have linear relationships with income. These findings set the stage for deeper inferential analysis in the final report.
